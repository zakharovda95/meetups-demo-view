"use strict";(self["webpackChunkvuejs_option_api_20220404_pet_project_meetups_spa"]=self["webpackChunkvuejs_option_api_20220404_pet_project_meetups_spa"]||[]).push([[591],{2773:function(e,t,a){a.d(t,{U:function(){return d}});const d="https://firebasestorage.googleapis.com/v0/b/meetups-ddc9b.appspot.com/o/covers%2Fmeetups_card__background.jpg?alt=media&token=744441d9-c81e-4332-82a5-f41e5cc96b58"},1873:function(e,t,a){a.d(t,{Z:function(){return c}});var d=a(3396),i=a(7139);const l={class:"image-uploader"},n={class:"text"},o=["disabled"];function s(e,t,a,s,u,r){return(0,d.wg)(),(0,d.iD)("div",l,[(0,d._)("label",{class:(0,i.C_)(["preview",r.uploaderClass]),style:(0,i.j5)({"background-image":r.bgImage})},[(0,d._)("span",n,(0,i.zw)(r.text),1),(0,d._)("input",{type:"file",ref:"input",accept:"image/*",class:"input",disabled:a.loading,onChange:t[0]||(t[0]=(...e)=>r.selectImage&&r.selectImage(...e)),onClick:t[1]||(t[1]=(...e)=>r.removeImg&&r.removeImg(...e))},null,40,o)],6)])}var u=a(2773),r={name:"UiImageUploader",emits:["select","error","remove"],props:{preview:String,loading:Boolean},inheritAttrs:!1,data:()=>({url:null}),mounted(){this.preview&&(this.url=this.preview)},methods:{selectImage(){const e=this.$refs.input.files[0];this.url=URL.createObjectURL(e),this.$emit("select",e),this.$toast.success("Картинка загружена!")},async removeImg(e){this.url&&(e.preventDefault(),this.$emit("remove"),this.url=void 0,this.$toast.success("Картинка удалена!")),this.$emit("remove"),this.$refs.input.value=null}},computed:{uploaderClass(){return{loading:this.loading}},bgImage(){return this.url?`linear-gradient(0deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${this.url})`:`linear-gradient( 0deg, rgba(0, 0, 0, 0.4), rgba(0, 0, 0, 0.4)), url(${u.U})`},text(){return this.url||this.loading?this.loading?"Загрузка...":this.url&&!this.loading?"Удалить изображение":"":"Загрузить изображение"}},beforeUnmount(){this.url=null,this.$refs.input.value=null}},m=a(89);const p=(0,m.Z)(r,[["render",s],["__scopeId","data-v-c92d9db6"]]);var c=p},9137:function(e,t,a){a.d(t,{Z:function(){return r}});var d=a(3396),i=a(7139);const l=["value"];function n(e,t,a,n,o,s){return(0,d.wg)(),(0,d.iD)("select",(0,d.dG)({class:"ui-dropdown"},e.$attrs,{onChange:t[0]||(t[0]=e=>s.modelValueProxy=e.target.value)}),[((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(a.options,(e=>((0,d.wg)(),(0,d.iD)("option",{value:e.value,key:e.name},(0,i.zw)(a.type)+": "+(0,i.zw)(e.name),9,l)))),128))],16)}var o={name:"UiDropdown",emits:["update:modelValue"],props:{options:{type:Array,required:!0,default:()=>[]},modelValue:String,type:String},computed:{modelValueProxy:{get(){return this.modelValue},set(e){this.$emit("update:modelValue",e)}}}},s=a(89);const u=(0,s.Z)(o,[["render",n],["__scopeId","data-v-6a9f82b1"]]);var r=u},1330:function(e,t,a){a.d(t,{Z:function(){return m}});var d=a(3396);const i=["type","value"];function l(e,t,a,l,n,o){return(0,d.wg)(),(0,d.iD)("input",{class:"ui-input-date",type:a.type,ref:"input",value:a.modelValue,onInput:t[0]||(t[0]=e=>o.modelValueProxy=e.target.value)},null,40,i)}var n=a(6797),o=a.n(n),s=(a(1085),{name:"UiInputDate",props:{type:{type:String,default:"date"},modelValue:{type:String}},computed:{modelValueProxy:{get(){return this.modelValue?"date"===this.type?o()(this.modelValue).utc().format("YYYY-MM-DD"):"time"===this.type?o().utc(this.modelValue).utc().format("HH:mm"):"datetime-local"===this.type&&o().utc(this.modelValue).utc().format("YYYY-MM-DDTHH:mm"):""},set(e){this.$emit("update:modelValue",e)}}}}),u=a(89);const r=(0,u.Z)(s,[["render",l],["__scopeId","data-v-6d9c2b61"]]);var m=r},9631:function(e,t,a){a.d(t,{Z:function(){return m}});var d=a(3396),i=a(7139);const l={class:"ui-label"},n={key:0};function o(e,t,a,o,s,u){return(0,d.wg)(),(0,d.iD)("div",l,[a.label?((0,d.wg)(),(0,d.iD)("label",n,(0,i.zw)(a.label),1)):(0,d.kq)("",!0),(0,d.WI)(e.$slots,"default",{},void 0,!0)])}var s={name:"UiLabel",props:{label:{type:String,require:!1}}},u=a(89);const r=(0,u.Z)(s,[["render",o],["__scopeId","data-v-5c8591b8"]]);var m=r},5300:function(e,t,a){a.r(t),a.d(t,{default:function(){return J}});var d=a(3396);const i={class:"edit-page"};function l(e,t,a,l,n,o){const s=(0,d.up)("EditView");return(0,d.wg)(),(0,d.iD)("div",i,[(0,d.Wm)(s)])}const n=e=>((0,d.dD)("data-v-a6d38ecc"),e=e(),(0,d.Cn)(),e),o={class:"edit-view"},s=n((()=>(0,d._)("h3",null,"Редактирование встречи",-1))),u={class:"uploader"},r={class:"forms"},m={class:"agenda"},p=n((()=>(0,d._)("h3",null,"Программа",-1))),c={class:"add-button"},g=(0,d.Uk)(" + Добавить пункт программы "),v={class:"editing-buttons"},b=(0,d.Uk)(" Сохранить "),h=(0,d.Uk)(" Отменить ");function I(e,t,a,i,l,n){const I=(0,d.up)("ImageUploader"),f=(0,d.up)("EditForm"),_=(0,d.up)("EditAgendaItemForm"),w=(0,d.up)("UiButton");return(0,d.wg)(),(0,d.iD)("div",o,[s,(0,d._)("div",u,[(0,d.Wm)(I,{class:"uploader",loading:e.isLoading,preview:n.editableMeetup.image,onSelect:n.selectImage,onRemove:n.removeImage},null,8,["loading","preview","onSelect","onRemove"])]),(0,d._)("div",r,[(0,d.Wm)(f,{class:"forms-item",loading:e.isLoading},null,8,["loading"])]),(0,d._)("div",m,[p,((0,d.wg)(!0),(0,d.iD)(d.HY,null,(0,d.Ko)(n.editableMeetup.agenda,(t=>((0,d.wg)(),(0,d.j4)(_,{key:t.id,loading:e.isLoading,class:"agenda-item","agenda-id":t.id},null,8,["loading","agenda-id"])))),128)),(0,d._)("div",c,[(0,d.Wm)(w,{disabled:e.isLoading,variant:"default",onClick:e.addAgendaItemToEditableMeetup},{default:(0,d.w5)((()=>[g])),_:1},8,["disabled","onClick"])])]),(0,d._)("div",v,[(0,d.Wm)(w,{disabled:e.isLoading,variant:"bgWrong",onClick:n.editMeetup},{default:(0,d.w5)((()=>[b])),_:1},8,["disabled","onClick"]),(0,d.Wm)(w,{disabled:e.isLoading,variant:"bgMain",onClick:n.cancel},{default:(0,d.w5)((()=>[h])),_:1},8,["disabled","onClick"])])])}var f=a(1873);const _={class:"edit-form"};function w(e,t,a,i,l,n){const o=(0,d.up)("UiInput"),s=(0,d.up)("UiLabel"),u=(0,d.up)("UiInputDate");return(0,d.wg)(),(0,d.iD)("div",_,[(0,d.Wm)(s,{label:"Заголовок"},{default:(0,d.w5)((()=>[(0,d.Wm)(o,{name:"title",disabled:a.loading,"model-value":n.editableMeetup.title,"onUpdate:modelValue":e.editTitle},null,8,["disabled","model-value","onUpdate:modelValue"])])),_:1}),(0,d.Wm)(s,{label:"Дата мероприятия"},{default:(0,d.w5)((()=>[(0,d.Wm)(u,{disabled:a.loading,"model-value":n.editableMeetup.date,"onUpdate:modelValue":e.editDate},null,8,["disabled","model-value","onUpdate:modelValue"])])),_:1}),(0,d.Wm)(s,{label:"Место проведения"},{default:(0,d.w5)((()=>[(0,d.Wm)(o,{name:"place",disabled:a.loading,"model-value":n.editableMeetup.place,"onUpdate:modelValue":e.editPlace},null,8,["disabled","model-value","onUpdate:modelValue"])])),_:1}),(0,d.Wm)(s,{label:"Описание"},{default:(0,d.w5)((()=>[(0,d.Wm)(o,{multiline:"",name:"description",disabled:a.loading,"model-value":n.editableMeetup.description,"onUpdate:modelValue":e.editDescription},null,8,["disabled","model-value","onUpdate:modelValue"])])),_:1})])}var U=a(9631),y=a(1085),A=a(1330),k=a(65),D={name:"EditForm",components:{UiLabel:U.Z,UiInput:y.Z,UiInputDate:A.Z},data:()=>({}),props:{loading:{type:Boolean,default:!1}},computed:{editableMeetup(){return this.$store.state.editing.editableMeetup}},methods:{...(0,k.nv)(["editTitle","editDate","editPlace","editDescription"])}},V=a(89);const W=(0,V.Z)(D,[["render",w],["__scopeId","data-v-8955c192"]]);var M=W;const $={class:"edit-agenda-item-form"},Z={class:"row-1"},E={class:"row-2"},L={class:"row-3"},C={key:0,class:"talk-group"},S={class:"row-4"},T={class:"row-5"},Y={key:1,class:"row-6"};function j(e,t,a,i,l,n){const o=(0,d.up)("UiDropdown"),s=(0,d.up)("UiIcon"),u=(0,d.up)("UiInputDate"),r=(0,d.up)("UiLabel"),m=(0,d.up)("UiInput");return(0,d.wg)(),(0,d.iD)("div",$,[(0,d._)("div",Z,[(0,d.Wm)(o,{options:e.options,type:"Тип",disabled:a.loading,"model-value":n.currentAgendaItem.type,"onUpdate:modelValue":t[0]||(t[0]=t=>e.editAgendaType([t,a.agendaId]))},null,8,["options","disabled","model-value"]),(0,d.Wm)(s,{onClick:t[1]||(t[1]=t=>e.removeEditableAgendaItem(a.agendaId)),class:"trash","icon-name":"trash"})]),(0,d._)("div",E,[(0,d.Wm)(r,{class:"startsAt",label:"Начало"},{default:(0,d.w5)((()=>[(0,d.Wm)(u,{type:"time",disabled:a.loading,"model-value":n.currentAgendaItem.startsAt,"onUpdate:modelValue":t[2]||(t[2]=t=>e.editAgendaStartsAt([t,a.agendaId]))},null,8,["disabled","model-value"])])),_:1}),(0,d.Wm)(r,{class:"endsAt",label:"Окончание"},{default:(0,d.w5)((()=>[(0,d.Wm)(u,{type:"time",disabled:a.loading,"model-value":n.currentAgendaItem.endsAt,"onUpdate:modelValue":t[3]||(t[3]=t=>e.editAgendaEndsAt([t,a.agendaId]))},null,8,["disabled","model-value"])])),_:1})]),(0,d._)("div",L,[(0,d.Wm)(r,{label:n.labelType},{default:(0,d.w5)((()=>[(0,d.Wm)(m,{name:"title",disabled:a.loading,"model-value":n.currentAgendaItem.title,"onUpdate:modelValue":t[4]||(t[4]=t=>e.editAgendaTitle([t,a.agendaId]))},null,8,["disabled","model-value"])])),_:1},8,["label"])]),"talk"===n.currentAgendaItem.type?((0,d.wg)(),(0,d.iD)("div",C,[(0,d._)("div",S,[(0,d.Wm)(r,{label:"Докладчик"},{default:(0,d.w5)((()=>[(0,d.Wm)(m,{name:"speaker",disabled:a.loading,"model-value":n.currentAgendaItem.speaker,"onUpdate:modelValue":t[5]||(t[5]=t=>e.editAgendaSpeaker([t,a.agendaId]))},null,8,["disabled","model-value"])])),_:1})]),(0,d._)("div",T,[(0,d.Wm)(o,{options:e.langOptions,type:"Язык",disabled:a.loading,"model-value":n.currentAgendaItem.language,"onUpdate:modelValue":t[6]||(t[6]=t=>e.editAgendaLanguage([t,a.agendaId]))},null,8,["options","disabled","model-value"])])])):(0,d.kq)("",!0),n.agendaType?((0,d.wg)(),(0,d.iD)("div",Y,[(0,d.Wm)(r,{label:"Описание"},{default:(0,d.w5)((()=>[(0,d.Wm)(m,{multiline:"",name:"description",disabled:a.loading,"model-value":n.currentAgendaItem.description,"onUpdate:modelValue":t[7]||(t[7]=t=>e.editAgendaDescription([t,a.agendaId]))},null,8,["disabled","model-value"])])),_:1})])):(0,d.kq)("",!0)])}var P=a(2395),q=a(9137),x=a(5367),z={name:"EditAgendaItemForm",components:{UiDropdown:q.Z,UiLabel:U.Z,UiInputDate:A.Z,UiInput:y.Z,UiIcon:x.Z},data:()=>({options:P.LZ,langOptions:P.Qv}),props:{agendaId:{type:String,required:!0,validator:e=>""!==e},loading:{type:Boolean,default:!1}},computed:{agenda(){return this.$store.state.editing.editableMeetup.agenda},currentAgendaItem(){let e=null;return this.agenda.forEach((t=>{this.agendaId===t.id&&(e=t)})),e},labelType(){return"talk"===this.currentAgendaItem.type||"other"===this.currentAgendaItem.type?"Тема":"Нестандартный текст (необязательно)"},agendaType(){return"talk"===this.currentAgendaItem.type||"other"===this.currentAgendaItem.type}},methods:{...(0,k.nv)(["editAgendaType","editAgendaStartsAt","editAgendaEndsAt","editAgendaTitle","editAgendaSpeaker","editAgendaLanguage","editAgendaDescription","removeEditableAgendaItem"])}};const F=(0,V.Z)(z,[["render",j],["__scopeId","data-v-2cac1760"]]);var H=F,B=a(9187),R=a(7491),O={name:"EditView",components:{EditAgendaItemForm:H,ImageUploader:f.Z,EditForm:M,UiButton:B.Z},data:()=>({file:null,isLoading:!1}),created(){this.getEditableMeetup(this.meetupId)},computed:{meetupId(){return this.$route.params.meetupId},editableMeetup(){return this.$store.state.editing.editableMeetup}},methods:{...(0,k.nv)(["getEditableMeetup","addAgendaItemToEditableMeetup"]),selectImage(e){this.file=e},removeImage(){this.file=null},cancel(){this.file=null,this.$router.push({name:"meetups"}),this.$toast.error("Редактирование митапа отменено")},async uploadImg(){try{await(0,R.JQ)("/covers/"+this.editableMeetup.imageName);const e=await(0,R.Gq)("/covers/",this.file),t=e.metadata.fullPath;this.editableMeetup.image=await(0,R.ii)(t),this.editableMeetup.imageId=this.$uuid.v1(),this.editableMeetup.imageName=e.metadata.name}catch(e){console.log(e),this.$toast.error("Что то пошло не так!")}},async editMeetup(){this.isLoading=!0,this.file&&await this.uploadImg(),await this.$store.dispatch("editMeetup"),await this.$router.push({name:"meetup",params:{meetupId:this.meetupId}}),await this.$toast.success("Редактирование завершено!"),this.isLoading=!1}}};const G=(0,V.Z)(O,[["render",I],["__scopeId","data-v-a6d38ecc"]]);var K=G,N={name:"EditPage",components:{EditView:K},computed:{isUserAuthorized(){return this.$store.state.user.data.isUserAuthorized}},methods:{guard(){this.isUserAuthorized||this.$router.replace({name:"meetups"})}},created(){this.guard()}};const Q=(0,V.Z)(N,[["render",l],["__scopeId","data-v-811ec558"]]);var J=Q}}]);
//# sourceMappingURL=591.00cffa1c.js.map